Q: HTTP 状态码 304 代表什么？

A: 304 即 304 Not Modified, 常见的应用场景是**浏览器缓存**: 当缓存中某一资源过期, 浏览器并不会直接向服务端请求该资源, 而是基于该资源对应版本的**唯一标记**向服务端发起**条件请求** If-Not-Match, 来验证该资源是否发生修改. 若版本标记一致, 则表明该资源并没有发生修改, 此时服务端将返回 304 Not Modified, 表示缓存中该资源可被直接使用. 反之则表明该资源已发生修改, 缓存中该资源的版本已过时, 服务端将响应该资源的最新版本

---

Q: 讲一下缓存, 强缓存和协商缓存

A: 我们首先将缓存简化为: 把原本需要浏览器向服务端发起网络请求才能获得的资源直接放在浏览器本地. 通过使用缓存, 既可以加快浏览器请求得到响应的速度(直接在本地读取), 又可以减轻服务端的网络压力(收到的资源请求减少)

缓存能够成立, 是基于这样一条规律: "浏览器请求的资源在一定时间内可能并不会发生改变". 在请求资源并未发生改变的时间段内, 与其重复请求相同的结果, 不如直接利用上一次请求的结果

但是资源不会发生改变的时间会持续多久? 谁都无法完全确定. 因此我们首先引入了**强缓存**机制: 服务端在响应报文中通过 `Cache-Control: max-age=[time]` 字段向浏览器保证在接下来的一段时间内, 该资源一定不会被修改. 因此这一时间段内, 浏览器对该资源的请求可以直接由本地版本响应

当资源作为强缓存的时间超过服务端保证的时间, 此时就引入了**协商缓存**机制: 浏览器将基于 `Etag` 字段发起条件请求 `If-None-Match`, 或是基于 `Last-Modified` 字段发起条件请求 `If-Modified-Since`, 向服务端询问: "该资源是否发生修改?" 若发生修改, 则服务端将返回 `200 OK` 并传输该资源的最新版本; 若未发生修改, 则服务端将返回 `304 Not Modified`, 告知浏览器可直接使用本地版本

E:

- 拓展缓存: CDN 和浏览器缓存细分
- 深入 `Etag`: 为什么需要用 `Etag` 来区分资源版本, 而不是直接用 `file-v1.0.0` 和 `file-v1.0.1`?